services:
  nbm-ingester:
    build: .
    image: ghcr.io/chancellor1101/nbm-ingester
    container_name: nbm-ingester
    
    environment:
      # Database connection
      DATABASE_URL: ${DATABASE_URL}
      
      # Redis connection (optional)
      REDIS_URL: ${REDIS_URL:-}
      
      # Configuration
      HOT_ZIPS: ${HOT_ZIPS:-5000}
      TMP_DIR: /tmp/nbm
    
    volumes:
      # Optional: mount for logs
      - ./logs:/app/logs
      
      # Optional: mount for persistent temp files (debugging)
      # - ./tmp:/tmp/nbm
    
    restart: "no"  # Run once and exit
    
    # Resource limits (adjust based on your system)
    
    # Network (if your DB is in another container)
    networks:
      - frontend
      - backend

networks:
  frontend:
    name: frontend
  backend:
    internal: true
    driver: bridge